#ifndef _EXTERNDATA_H
#define _EXTERNDATA_H

//Gf(2^4) f(x)=x^4+x+1
#define f_x_4 0x13 //10011

//Gf(2^8) f(x)=x^8+x^4+x^3+x+1
#define f_x_8 0x11B //{100011011

// For CMS
#define C1 5
#define C2 8

//-------------------------------------------------------------------------------
typedef void (*fun)(unsigned short&,unsigned short*,unsigned short);
typedef void (*linear)(unsigned short&);

linear Lpart=NULL;
linear iLpart=NULL;
fun encrypt=NULL;
fun decrypt=NULL;

unsigned short n_cicles_b=1;
unsigned short n_cicles_e=13;
unsigned short NumberKey=30;
unsigned int FullDifTable[65536]={};

//Sbox
unsigned short Sbox[16]={};
unsigned short iSbox[16]={};

//Sbox rijndael dif=4
unsigned short SboxAESD4[16]={0xA,0x4,0x3,0xB,0x8,0xE,0x2,0xC,0x5,0x7,0x6,0xF,0x0,0x1,0x9,0xD};
unsigned short iSboxAESD4[16]={0xc,0xd,0x6,0x2,0x1,0x8,0xa,0x9,0x4,0xe,0x0,0x3,0x7,0xf,0x5,0xb};

//Sbox heys dif=8
unsigned short SboxHEYSD8[16]={0xE,0x4,0xD,0x1,0x2,0xF,0xB,0x8,0x3,0xA,0x6,0xC,0x5,0x9,0x0,0x7};
unsigned short iSboxHEYSD8[16]={0xE,0x3,0x4,0x8,0x1,0xC,0xA,0xF,0x7,0xD,0x9,0x6,0xB,0x2,0x0,0x5};

//Sbox dif=6 2 фикс точки 7 и 8
unsigned short SboxD8F2[16]={0xB,0xC,0x5,0x0,0x1,0x3,0x2,0x7,0x8,0x4,0xD,0xF,0x6,0x9,0xE,0xA};
unsigned short iSboxD8F2[16]={0x3,0x4,0x6,0x5,0x9,0x2,0xC,0x7,0x8,0xD,0xF,0x0,0x1,0xA,0xE,0xB};

//Sbox dif=6
unsigned short SboxD6F0[16]={0x4,0x6,0xF,0xB,0xE,0x7,0x5,0xD,0x9,0xC,0x1,0x0,0x3,0x8,0xA,0x2};
unsigned short iSboxD6F0[16]={0xB,0xA,0xF,0xC,0x0,0x6,0x1,0x5,0xD,0x8,0xE,0x3,0x9,0x7,0x4,0x2};

//Sbox dif=8
unsigned short SboxD8F0[16]={0xC,0x9,0x4,0x6,0x8,0xE,0xD,0x5,0x3,0xF,0xB,0x0,0xA,0x2,0x1,0x7};
unsigned short iSboxD8F0[16]={0xB,0xE,0xD,0x8,0x2,0x7,0x3,0xF,0x4,0x1,0xC,0xA,0x0,0x6,0x5,0x9};

//Sbox dif=12
unsigned short SboxD12[16]={0x8,0x3,0x1,0x9,0xA,0xB,0xE,0xC,0x5,0xD,0xF,0x2,0x0,0x4,0x7,0x6};
unsigned short iSboxD12[16]={0xC,0x2,0xB,0x1,0xD,0x8,0xF,0xE,0x0,0x3,0x4,0x5,0x7,0x9,0x6,0xA};

//Sbox dif=12
unsigned short LSbox[16][16]={
							{0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD},
							{0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3},
							{0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA},
							{0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF},
							{0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4},
							{0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC},
							{0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1},
							{0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5},
							{0x9,0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2},
							{0x7,0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9},
							{0x0,0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7},
							{0x8,0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0},
							{0xE,0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8},
							{0x6,0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE},
							{0xB,0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6},
							{0xD,0x3,0xA,0xF,0x4,0xC,0x1,0x5,0x2,0x9,0x7,0x0,0x8,0xE,0x6,0xB}
							};
unsigned short iLSbox[16][16]={
							{0xA,0x5,0x7,0x0,0x3,0x6,0xD,0x9,0xB,0x8,0x1,0xE,0x4,0xF,0xC,0x2},
							{0x9,0x4,0x6,0xF,0x2,0x5,0xC,0x8,0xA,0x7,0x0,0xD,0x3,0xE,0xB,0x1},
							{0x8,0x3,0x5,0xE,0x1,0x4,0xB,0x7,0x9,0x6,0xF,0xC,0x2,0xD,0xA,0x0},
							{0x7,0x2,0x4,0xD,0x0,0x3,0xA,0x6,0x8,0x5,0xE,0xB,0x1,0xC,0x9,0xF},
							{0x6,0x1,0x3,0xC,0xF,0x2,0x9,0x5,0x7,0x4,0xD,0xA,0x0,0xB,0x8,0xE},
							{0x5,0x0,0x2,0xB,0xE,0x1,0x8,0x4,0x6,0x3,0xC,0x9,0xF,0xA,0x7,0xD},
							{0x4,0xF,0x1,0xA,0xD,0x0,0x7,0x3,0x5,0x2,0xB,0x8,0xE,0x9,0x6,0xC},
							{0x3,0xE,0x0,0x9,0xC,0xF,0x6,0x2,0x4,0x1,0xA,0x7,0xD,0x8,0x5,0xB},
							{0x2,0xD,0xF,0x8,0xB,0xE,0x5,0x1,0x3,0x0,0x9,0x6,0xC,0x7,0x4,0xA},
							{0x1,0xC,0xE,0x7,0xA,0xD,0x4,0x0,0x2,0xF,0x8,0x5,0xB,0x6,0x3,0x9},
							{0x0,0xB,0xD,0x6,0x9,0xC,0x3,0xF,0x1,0xE,0x7,0x4,0xA,0x5,0x2,0x8},
							{0xF,0xA,0xC,0x5,0x8,0xB,0x2,0xE,0x0,0xD,0x6,0x3,0x9,0x4,0x1,0x7},
							{0xE,0x9,0xB,0x4,0x7,0xA,0x1,0xD,0xF,0xC,0x5,0x2,0x8,0x3,0x0,0x6},
							{0xD,0x8,0xA,0x3,0x6,0x9,0x0,0xC,0xE,0xB,0x4,0x1,0x7,0x2,0xF,0x5},
							{0xC,0x7,0x9,0x2,0x5,0x8,0xF,0xB,0xD,0xA,0x3,0x0,0x6,0x1,0xE,0x4},
							{0xB,0x6,0x8,0x1,0x4,0x7,0xE,0xA,0xC,0x9,0x2,0xF,0x5,0x0,0xD,0x3}
							};

#endif // /* _EXTERNDATA_H */